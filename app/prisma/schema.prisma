datasource db {
  provider = "postgresql"
  url = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
}

model User {
  id        Int          @id @default(autoincrement())
  email     String       @unique
  username  String?
  hashedPassword String
  conversations Conversation[]
}

model Conversation {
  id        Int       @id @default(autoincrement())
  userId    Int
  messages  Message[]
  user      User      @relation(fields: [userId], references: [id])
}

model Message {
  id            Int      @id @default(autoincrement())
  conversationId Int
  type          String   // 'query' or 'response'
  text          String
  timestamp     DateTime @default(now())
  reactions     Reaction[]
  feedback      String?
  conversation  Conversation @relation(fields: [conversationId], references: [id])
}

model Reaction {
  id          Int      @id @default(autoincrement())
  messageId   Int
  type        String   // 'like', 'dislike', etc.
  count       Int      @default(0)
  message     Message  @relation(fields: [messageId], references: [id])
}


