"use client";
import useThemeToggler from "@/lib/hooks/useThemeToggler";
import {
  ActionIcon,
  Button,
  MantineColorScheme,
  Modal,
  Select,
  Switch,
  Tooltip,
} from "@mantine/core";
import { modals } from "@mantine/modals";
import { useRouter } from "next/navigation";
import React from "react";
import { MdSettings } from "react-icons/md";

interface SettingsItemProps {
  readonly title: string;
  readonly description: string;
  readonly action: React.ReactNode;
}

// TODO: integrate with backend functionality

function Settings() {
  const router = useRouter();
  const { theme, preferredTheme, updateTheme } = useThemeToggler();

  const items: SettingsItemProps[] = [
    {
      title: "THEME",
      description: "App theme",
      action: (
        <Select
          variant='default'
          defaultValue={theme}
          placeholder={`${theme} mode`}
          data={[
            { value: "light", label: "Light mode" },
            { value: "dark", label: "Dark mode" },
            {
              value: "auto",
              label: `System mode`,
            },
          ]}
          onChange={(value) => updateTheme(value as MantineColorScheme)}
        />
      ),
    },
    {
      title: "CHAT",
      description: "Chat history",
      action: <Switch defaultChecked />,
    },
    {
      title: "EXPORT",
      description: "Export data",
      action: (
        <Tooltip
          label={
            <ul className='list-disc'>
              <li className='text-sm'>
                Your export will encompass both account details and
                conversations.
              </li>
              <li className='text-sm'>
                The data will be delivered to your registered email as a
                downloadable file.
              </li>
              <li className='text-sm'>
                Please note that the download link will become inactive 24 hours
                after you receive it.
              </li>
              <li className='text-sm'>
                Expect some processing time; we will notify you once it&apos;s
                prepared.
              </li>
            </ul>
          }
          position='bottom'
          multiline
          w={200}
          withArrow>
          <Button
            variant='outline'
            onClick={(e) => {
              e.preventDefault();

              modals.open({
                title: (
                  <div className='flex items-center space-x-4'>
                    <svg
                      width='32'
                      height='32'
                      viewBox='0 0 32 32'
                      fill='none'
                      xmlns='http://www.w3.org/2000/svg'>
                      <rect width='32' height='32' rx='8' fill='#BCFFD3' />
                      <path
                        d='M13.0257 14.4399L12.995 14.1079C11.9058 14.2085 11.08 14.5225 10.5424 15.2033C10.0146 15.8717 9.81901 16.828 9.81901 18.0799V18.1665C9.81901 19.5463 10.0596 20.5801 10.7358 21.2564C11.4121 21.9326 12.4459 22.1732 13.8257 22.1732H18.1723C19.5521 22.1732 20.586 21.9326 21.2622 21.2564C21.9385 20.5801 22.179 19.5463 22.179 18.1665V18.0799C22.179 16.821 21.98 15.86 21.4421 15.191C20.8953 14.5109 20.0563 14.2017 18.9498 14.1079C18.8517 14.0975 18.7895 14.0131 18.7974 13.9322C18.8073 13.831 18.8877 13.7701 18.9741 13.7784L18.9773 13.7786C20.2503 13.8874 21.1118 14.2796 21.6639 14.9466C22.2218 15.6206 22.5123 16.6333 22.5123 18.0865V18.1732C22.5123 19.7645 22.1694 20.8229 21.5011 21.4897C20.8326 22.1568 19.7707 22.4999 18.1723 22.4999H13.8257C12.2274 22.4999 11.1657 22.1568 10.4972 21.4883C9.82876 20.8199 9.48568 19.7582 9.48568 18.1599V18.0732C9.48568 16.6295 9.77139 15.6226 10.3206 14.9498C10.8631 14.2851 11.7092 13.8908 12.9596 13.7721C13.0538 13.7664 13.1391 13.8422 13.1473 13.9256C13.156 14.0156 13.0903 14.0989 12.9941 14.108L13.0257 14.4399ZM13.0257 14.4399C13.3057 14.4132 13.5057 14.1665 13.479 13.8932C13.4523 13.6199 13.199 13.4199 12.9323 13.4399L18.919 14.4399C21.0523 14.6199 21.8457 15.6065 21.8457 18.0799V18.1665C21.8457 20.8799 20.8857 21.8399 18.1723 21.8399H13.8257C11.1123 21.8399 10.1523 20.8799 10.1523 18.1665V18.0799C10.1523 15.6199 10.9323 14.6332 13.0257 14.4399Z'
                        fill='#04802E'
                        stroke='#04802E'
                        strokeWidth='0.666667'
                      />
                      <path
                        d='M16 18.1664C15.9108 18.1664 15.8333 18.089 15.8333 17.9998V10.4131C15.8333 10.3238 15.9108 10.2464 16 10.2464C16.0892 10.2464 16.1667 10.3238 16.1667 10.4131V17.9998C16.1667 18.089 16.0892 18.1664 16 18.1664Z'
                        fill='#04802E'
                        stroke='#04802E'
                        strokeWidth='0.666667'
                      />
                      <path
                        d='M16.2369 10.1373L16.0012 9.90156L15.7655 10.1373L13.8855 12.0173C13.8223 12.0804 13.7134 12.0804 13.6502 12.0173C13.5871 11.9541 13.5871 11.8452 13.6502 11.782L15.8836 9.54867C15.9467 9.48551 16.0557 9.48551 16.1188 9.54867L18.3522 11.782C18.4153 11.8452 18.4153 11.9541 18.3522 12.0173L18.352 12.0171L18.3442 12.0255C18.324 12.0471 18.2848 12.0663 18.2345 12.0663C18.1915 12.0663 18.1511 12.0515 18.1169 12.0173L16.2369 10.1373Z'
                        fill='#04802E'
                        stroke='#04802E'
                        strokeWidth='0.666667'
                      />
                    </svg>

                    <h6>Export Successfully Completed</h6>
                  </div>
                ),

                children: (
                  <div>
                    <p className='text-sm'>
                      Your chat data has been sent to your registered email
                      toodoos@gmail.com and can be downloaded there.
                    </p>

                    <Button
                      variant='filled'
                      className='mt-6'
                      onClick={(e) => {
                        e.preventDefault();
                        modals.closeAll();
                      }}>
                      Continue
                    </Button>
                  </div>
                ),
              });
            }}>
            Export
          </Button>
        </Tooltip>
      ),
    },
    {
      title: "ACCOUNT",
      description: "Deactivate your account",
      action: (
        <Tooltip
          position='bottom'
          multiline
          w={200}
          withArrow
          label="Please note that deactivating your account is irreversible and will result in the permanent loss of all data and access associated with it. If you proceed, you won't be able to recover your account or its contents. If you have any concerns, consider reaching out to our support team for assistance before making this decision.">
          <Button
            color='red'
            onClick={(e) => {
              e.preventDefault();

              modals.openConfirmModal({
                title: (
                  <div className='flex items-center space-x-4'>
                    <svg
                      width='32'
                      height='32'
                      viewBox='0 0 32 32'
                      fill='none'
                      xmlns='http://www.w3.org/2000/svg'>
                      <rect width='32' height='32' rx='8' fill='#FFA9A9' />
                      <path
                        d='M15.9987 22.833C12.2295 22.833 9.16536 19.7689 9.16536 15.9997C9.16536 12.2304 12.2295 9.16634 15.9987 9.16634C19.7679 9.16634 22.832 12.2304 22.832 15.9997C22.832 19.7689 19.7679 22.833 15.9987 22.833ZM15.9987 9.49967C12.4146 9.49967 9.4987 12.4156 9.4987 15.9997C9.4987 19.5838 12.4146 22.4997 15.9987 22.4997C19.5828 22.4997 22.4987 19.5838 22.4987 15.9997C22.4987 12.4156 19.5828 9.49967 15.9987 9.49967Z'
                        fill='#C91111'
                        stroke='#C91111'
                        strokeWidth='0.666667'
                      />
                      <path
                        d='M16 16.833C15.9108 16.833 15.8333 16.7556 15.8333 16.6663V13.333C15.8333 13.2438 15.9108 13.1663 16 13.1663C16.0892 13.1663 16.1667 13.2438 16.1667 13.333V16.6663C16.1667 16.7556 16.0892 16.833 16 16.833Z'
                        fill='#C91111'
                        stroke='#C91111'
                        strokeWidth='0.666667'
                      />
                      <path
                        d='M15.6965 18.7999L15.6966 18.7999L15.6931 18.7914C15.6739 18.7455 15.6654 18.7024 15.6654 18.6663C15.6654 18.6302 15.6739 18.587 15.6931 18.5411C15.7094 18.502 15.7318 18.4648 15.7616 18.4292C15.7973 18.3993 15.8344 18.3769 15.8736 18.3606C15.9515 18.3281 16.0459 18.3281 16.1238 18.3606C16.163 18.3769 16.2001 18.3993 16.2358 18.4292C16.2656 18.4648 16.288 18.502 16.3043 18.5411C16.3235 18.587 16.332 18.6302 16.332 18.6663C16.332 18.7024 16.3235 18.7455 16.3043 18.7914L16.3042 18.7913L16.3009 18.7999C16.2878 18.8341 16.27 18.8637 16.2364 18.9029C16.2005 18.933 16.1632 18.9555 16.1238 18.9719C16.0779 18.991 16.0348 18.9996 15.9987 18.9996C15.9626 18.9996 15.9195 18.991 15.8736 18.9719C15.8342 18.9555 15.7969 18.933 15.761 18.9029C15.7274 18.8637 15.7096 18.8341 15.6965 18.7999Z'
                        fill='#C91111'
                        stroke='#C91111'
                        strokeWidth='0.666667'
                      />
                    </svg>

                    <h6>Deactivate account?</h6>
                  </div>
                ),
                labels: {
                  confirm: "Deactivate account",
                  cancel: "Cancel",
                },
                confirmProps: { color: "red" },
                children: (
                  <p className='text-sm'>
                    Are you sure you want to deactivate your account? You will
                    not be able to login or communicate with Gabeth.Ai using
                    this account once it is deleted.
                  </p>
                ),
              });
            }}>
            Deactivate
          </Button>
        </Tooltip>
      ),
    },
  ];

  return (
    <ActionIcon
      variant='default'
      aria-label='Settings'
      onClick={async (e) => {
        e.preventDefault();

        modals.open({
          title: (
            <div className='flex items-center space-x-4'>
              <svg
                className='fill-black dark:fill-white'
                width='16'
                height='16'
                viewBox='0 0 16 16'
                fill='none'
                xmlns='http://www.w3.org/2000/svg'>
                <path
                  d='M8 10.5C6.62 10.5 5.5 9.38 5.5 8C5.5 6.62 6.62 5.5 8 5.5C9.38 5.5 10.5 6.62 10.5 8C10.5 9.38 9.38 10.5 8 10.5ZM8 6.5C7.17333 6.5 6.5 7.17333 6.5 8C6.5 8.82667 7.17333 9.5 8 9.5C8.82667 9.5 9.5 8.82667 9.5 8C9.5 7.17333 8.82667 6.5 8 6.5Z'
                  fill='inherit'
                />
                <path
                  d='M10.1387 14.7932C9.9987 14.7932 9.8587 14.7732 9.7187 14.7399C9.30536 14.6265 8.9587 14.3665 8.7387 13.9999L8.6587 13.8665C8.26536 13.1865 7.72536 13.1865 7.33203 13.8665L7.2587 13.9932C7.0387 14.3665 6.69203 14.6332 6.2787 14.7399C5.8587 14.8532 5.42536 14.7932 5.0587 14.5732L3.91203 13.9132C3.50536 13.6799 3.21203 13.2999 3.08536 12.8399C2.96536 12.3799 3.02536 11.9065 3.2587 11.4999C3.45203 11.1599 3.50536 10.8532 3.39203 10.6599C3.2787 10.4665 2.99203 10.3532 2.5987 10.3532C1.62536 10.3532 0.832031 9.55987 0.832031 8.58653V7.4132C0.832031 6.43987 1.62536 5.64653 2.5987 5.64653C2.99203 5.64653 3.2787 5.5332 3.39203 5.33987C3.50536 5.14653 3.4587 4.83987 3.2587 4.49987C3.02536 4.0932 2.96536 3.6132 3.08536 3.15987C3.20536 2.69987 3.4987 2.31987 3.91203 2.08653L5.06536 1.42653C5.8187 0.979865 6.81203 1.23987 7.26536 2.00653L7.34537 2.13987C7.7387 2.81987 8.2787 2.81987 8.67203 2.13987L8.74536 2.0132C9.1987 1.23987 10.192 0.979865 10.952 1.4332L12.0987 2.0932C12.5054 2.32653 12.7987 2.70653 12.9254 3.16653C13.0454 3.62653 12.9854 4.09987 12.752 4.50653C12.5587 4.84653 12.5054 5.1532 12.6187 5.34653C12.732 5.53987 13.0187 5.6532 13.412 5.6532C14.3854 5.6532 15.1787 6.44653 15.1787 7.41987V8.5932C15.1787 9.56653 14.3854 10.3599 13.412 10.3599C13.0187 10.3599 12.732 10.4732 12.6187 10.6665C12.5054 10.8599 12.552 11.1665 12.752 11.5065C12.9854 11.9132 13.052 12.3932 12.9254 12.8465C12.8054 13.3065 12.512 13.6865 12.0987 13.9199L10.9454 14.5799C10.692 14.7199 10.4187 14.7932 10.1387 14.7932ZM7.9987 12.3265C8.59203 12.3265 9.14536 12.6999 9.52536 13.3599L9.5987 13.4865C9.6787 13.6265 9.81203 13.7265 9.97203 13.7665C10.132 13.8065 10.292 13.7865 10.4254 13.7065L11.5787 13.0399C11.752 12.9399 11.8854 12.7732 11.9387 12.5732C11.992 12.3732 11.9654 12.1665 11.8654 11.9932C11.4854 11.3399 11.4387 10.6665 11.732 10.1532C12.0254 9.63986 12.632 9.34653 13.392 9.34653C13.8187 9.34653 14.1587 9.00653 14.1587 8.57987V7.40653C14.1587 6.98653 13.8187 6.63987 13.392 6.63987C12.632 6.63987 12.0254 6.34653 11.732 5.8332C11.4387 5.31987 11.4854 4.64653 11.8654 3.9932C11.9654 3.81987 11.992 3.6132 11.9387 3.4132C11.8854 3.2132 11.7587 3.0532 11.5854 2.94653L10.432 2.28653C10.1454 2.1132 9.76536 2.2132 9.59203 2.50653L9.5187 2.6332C9.1387 3.2932 8.58536 3.66653 7.99203 3.66653C7.3987 3.66653 6.84536 3.2932 6.46536 2.6332L6.39203 2.49987C6.22536 2.21987 5.85203 2.11987 5.56536 2.28653L4.41203 2.9532C4.2387 3.0532 4.10536 3.21987 4.05203 3.41987C3.9987 3.61987 4.02536 3.82653 4.12536 3.99987C4.50536 4.6532 4.55203 5.32653 4.2587 5.83987C3.96536 6.3532 3.3587 6.64653 2.5987 6.64653C2.17203 6.64653 1.83203 6.98653 1.83203 7.4132V8.58653C1.83203 9.00653 2.17203 9.3532 2.5987 9.3532C3.3587 9.3532 3.96536 9.64653 4.2587 10.1599C4.55203 10.6732 4.50536 11.3465 4.12536 11.9999C4.02536 12.1732 3.9987 12.3799 4.05203 12.5799C4.10536 12.7799 4.23203 12.9399 4.40536 13.0465L5.5587 13.7065C5.6987 13.7932 5.86536 13.8132 6.0187 13.7732C6.1787 13.7332 6.31203 13.6265 6.3987 13.4865L6.47203 13.3599C6.85203 12.7065 7.40536 12.3265 7.9987 12.3265Z'
                  fill='inherit'
                />
              </svg>
              <span className='text-lg font-semibold'>Settings</span>
            </div>
          ),
          centered: true,
          children: (
            <div className='space-y-5'>
              {items.map((item) => (
                <div
                  className='flex items-center justify-between'
                  key={item.title}>
                  <div>
                    <h3 className='text-lg font-semibold mb-2'>{item.title}</h3>
                    <p className='text-sm text-gray-500'>{item.description}</p>
                  </div>
                  <div>{item.action}</div>
                </div>
              ))}
            </div>
          ),
        });
      }}>
      <svg
        width='24'
        height='24'
        viewBox='0 0 24 24'
        fill='none'
        xmlns='http://www.w3.org/2000/svg'>
        <path
          d='M12 15.75C9.93 15.75 8.25 14.07 8.25 12C8.25 9.93 9.93 8.25 12 8.25C14.07 8.25 15.75 9.93 15.75 12C15.75 14.07 14.07 15.75 12 15.75ZM12 9.75C10.76 9.75 9.75 10.76 9.75 12C9.75 13.24 10.76 14.25 12 14.25C13.24 14.25 14.25 13.24 14.25 12C14.25 10.76 13.24 9.75 12 9.75Z'
          fill='#818181'
        />
        <path
          d='M15.21 22.1903C15 22.1903 14.79 22.1603 14.58 22.1103C13.96 21.9403 13.44 21.5503 13.11 21.0003L12.99 20.8003C12.4 19.7803 11.59 19.7803 11 20.8003L10.89 20.9903C10.56 21.5503 10.04 21.9503 9.42 22.1103C8.79 22.2803 8.14 22.1903 7.59 21.8603L5.87 20.8703C5.26 20.5203 4.82 19.9503 4.63 19.2603C4.45 18.5703 4.54 17.8603 4.89 17.2503C5.18 16.7403 5.26 16.2803 5.09 15.9903C4.92 15.7003 4.49 15.5303 3.9 15.5303C2.44 15.5303 1.25 14.3403 1.25 12.8803V11.1203C1.25 9.66029 2.44 8.47029 3.9 8.47029C4.49 8.47029 4.92 8.30029 5.09 8.01029C5.26 7.72029 5.19 7.26029 4.89 6.75029C4.54 6.14029 4.45 5.42029 4.63 4.74029C4.81 4.05029 5.25 3.48029 5.87 3.13029L7.6 2.14029C8.73 1.47029 10.22 1.86029 10.9 3.01029L11.02 3.21029C11.61 4.23029 12.42 4.23029 13.01 3.21029L13.12 3.02029C13.8 1.86029 15.29 1.47029 16.43 2.15029L18.15 3.14029C18.76 3.49029 19.2 4.06029 19.39 4.75029C19.57 5.44029 19.48 6.15029 19.13 6.76029C18.84 7.27029 18.76 7.73029 18.93 8.02029C19.1 8.31029 19.53 8.48029 20.12 8.48029C21.58 8.48029 22.77 9.67029 22.77 11.1303V12.8903C22.77 14.3503 21.58 15.5403 20.12 15.5403C19.53 15.5403 19.1 15.7103 18.93 16.0003C18.76 16.2903 18.83 16.7503 19.13 17.2603C19.48 17.8703 19.58 18.5903 19.39 19.2703C19.21 19.9603 18.77 20.5303 18.15 20.8803L16.42 21.8703C16.04 22.0803 15.63 22.1903 15.21 22.1903ZM12 18.4903C12.89 18.4903 13.72 19.0503 14.29 20.0403L14.4 20.2303C14.52 20.4403 14.72 20.5903 14.96 20.6503C15.2 20.7103 15.44 20.6803 15.64 20.5603L17.37 19.5603C17.63 19.4103 17.83 19.1603 17.91 18.8603C17.99 18.5603 17.95 18.2503 17.8 17.9903C17.23 17.0103 17.16 16.0003 17.6 15.2303C18.04 14.4603 18.95 14.0203 20.09 14.0203C20.73 14.0203 21.24 13.5103 21.24 12.8703V11.1103C21.24 10.4803 20.73 9.96029 20.09 9.96029C18.95 9.96029 18.04 9.52029 17.6 8.75029C17.16 7.98029 17.23 6.97029 17.8 5.99029C17.95 5.73029 17.99 5.42029 17.91 5.12029C17.83 4.82029 17.64 4.58029 17.38 4.42029L15.65 3.43029C15.22 3.17029 14.65 3.32029 14.39 3.76029L14.28 3.95029C13.71 4.94029 12.88 5.50029 11.99 5.50029C11.1 5.50029 10.27 4.94029 9.7 3.95029L9.59 3.75029C9.34 3.33029 8.78 3.18029 8.35 3.43029L6.62 4.43029C6.36 4.58029 6.16 4.83029 6.08 5.13029C6 5.43029 6.04 5.74029 6.19 6.00029C6.76 6.98029 6.83 7.99029 6.39 8.76029C5.95 9.53029 5.04 9.97029 3.9 9.97029C3.26 9.97029 2.75 10.4803 2.75 11.1203V12.8803C2.75 13.5103 3.26 14.0303 3.9 14.0303C5.04 14.0303 5.95 14.4703 6.39 15.2403C6.83 16.0103 6.76 17.0203 6.19 18.0003C6.04 18.2603 6 18.5703 6.08 18.8703C6.16 19.1703 6.35 19.4103 6.61 19.5703L8.34 20.5603C8.55 20.6903 8.8 20.7203 9.03 20.6603C9.27 20.6003 9.47 20.4403 9.6 20.2303L9.71 20.0403C10.28 19.0603 11.11 18.4903 12 18.4903Z'
          fill='#818181'
        />
      </svg>
    </ActionIcon>
  );
}

export default Settings;
